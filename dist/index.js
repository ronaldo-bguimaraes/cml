(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{transpile:()=>p});const r={get STRING(){return new RegExp("(\"(?:.*?)\"|'(?:.*?)')")},get DOCTYPE(){return new RegExp("(!doctype)","i")},get WORD(){return new RegExp("(\\b(?:[\\w-]+)\\b)")},get MODULE(){return new RegExp(`(@${this.WORD.source})`)},get KEYWORD(){return new RegExp(`(\\$${this.WORD.source})`)},get TAG(){return new RegExp(`(${this.DOCTYPE.source}|${this.WORD.source}|${this.MODULE.source})`,"i")},get OPEN_BRACKET(){return new RegExp("(\\[)")},get CLOSE_BRACKET(){return new RegExp("(\\])")},get BRACKETS(){return new RegExp(`(${this.OPEN_BRACKET.source}|${this.CLOSE_BRACKET.source})`)},get OPEN_BRACE(){return new RegExp("({)")},get CLOSE_BRACE(){return new RegExp("(})")},get BRACES(){return new RegExp(`(${this.OPEN_BRACE.source}|${this.CLOSE_BRACE.source})`)},get EQUAL(){return new RegExp("(=)")},get NEW_LINE(){return new RegExp("(\\n)")},get MATCH(){return new RegExp(`(${this.STRING.source}|${this.TAG.source}|${this.KEYWORD.source}|${this.BRACKETS.source}|${this.BRACES.source}|${this.EQUAL.source}|${this.NEW_LINE.source})`,"gi")}},n={get STRING(){return new RegExp(`^${r.STRING.source}$`)},get DOCTYPE(){return new RegExp(`^${r.DOCTYPE.source}$`,"i")},get WORD(){return new RegExp(`^${r.WORD.source}$`)},get MODULE(){return new RegExp(`^${r.MODULE.source}$`)},get KEYWORD(){return new RegExp(`^${r.KEYWORD.source}$`)},get TAG(){return new RegExp(`^${r.TAG.source}$`,"i")},get OPEN_BRACKET(){return new RegExp(`^${r.OPEN_BRACKET.source}$`)},get CLOSE_BRACKET(){return new RegExp(`^${r.CLOSE_BRACKET.source}$`)},get BRACKETS(){return new RegExp(`^${r.BRACKETS.source}$`)},get OPEN_BRACE(){return new RegExp(`^${r.OPEN_BRACE.source}$`)},get CLOSE_BRACE(){return new RegExp(`^${r.CLOSE_BRACE.source}$`)},get BRACES(){return new RegExp(`^${r.BRACES.source}$`)},get EQUAL(){return new RegExp(`^${r.EQUAL.source}$`)},get NEW_LINE(){return new RegExp(`^${r.NEW_LINE.source}$`)},get MATCH(){return new RegExp(`^${r.MATCH.source}$`,"gi")}};var E;!function(e){e[e.DOCTYPE=0]="DOCTYPE",e[e.CHILDREN=1]="CHILDREN",e[e.ATTRIBUTE=2]="ATTRIBUTE",e[e.EQUAL=3]="EQUAL",e[e.VALUE=4]="VALUE",e[e.OPEN_BRACE=5]="OPEN_BRACE"}(E||(E={}));class s{name;attributes=new Map;children=[];parent;constructor(e){this.name=e}appendChild(e){return this.children.push(e),e instanceof s&&(e.parent=this),e}get root(){return void 0!==this.parent?this.parent.root:this}}const o=new Map;function i(e,t){for(const r of e.children)if("$children"===r){const n=e.children.indexOf(r);e.children.splice(n,1,...t)}}function u(e,t){for(const r of e.children)if(r instanceof s)if(/^(declare)$/.test(r.name))u(r,!0),e.children=e.children.filter((e=>e!==r));else if(n.MODULE.test(r.name))if(void 0===t||!0===t)o.set(r.name,r);else{const t=o.get(r.name);if(void 0===t)throw new Error(`Module ${r.name} not found!`);{const n=t.children[0];if(n instanceof s){const t=new s(n.name);for(const e of n.attributes)t.attributes.set(e[0],e[1]);for(const e of r.attributes)t.attributes.set(e[0],e[1]);for(const e of n.children)t.children.push(e);t.parent=r.parent,i(t,r.children);const E=e.children.indexOf(r);e.children.splice(E,1,t)}}}else u(r,!1);return e}const c=new RegExp("^(!doctype|area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$","i");function R(e){const t=[],r=[];for(const r of e.children)t.push(r instanceof s?R(r):r);for(const t of e.attributes)r.push(` ${t[0]}${t[1]?`=${t[1]}`:""}`);return void 0!==e.parent?`<${e.name}${r.join("")}>${c.test(e.name)?"":`${t.join("")}</${e.name}>`}`:`${t.join("")}`}function p(e){return R(u(function(e){let t,r=E.DOCTYPE,o=new s("document"),i=!1;function u(e){const t=new s(e);o=o.appendChild(t),r=E.ATTRIBUTE}function c(){void 0!==o.parent&&(o=o.parent)}for(const s of e)r===E.DOCTYPE?n.TAG.test(s)&&u(s):r===E.CHILDREN?n.STRING.test(s)?o.appendChild(s.slice(1,-1)):n.KEYWORD.test(s)?o.appendChild(s):n.TAG.test(s)?u(s):n.CLOSE_BRACE.test(s)&&c():r===E.OPEN_BRACE?n.OPEN_BRACE.test(s)?r=E.CHILDREN:(c(),n.KEYWORD.test(s)?o.appendChild(s):n.STRING.test(s)?o.appendChild(s.slice(1,-1)):n.TAG.test(s)&&u(s)):r===E.ATTRIBUTE?n.WORD.test(s)?(t=s,o.attributes.set(t,void 0),r=E.EQUAL):n.NEW_LINE.test(s)&&!1===i?r=E.OPEN_BRACE:n.OPEN_BRACE.test(s)?r=E.CHILDREN:n.OPEN_BRACKET.test(s)?i=!0:n.CLOSE_BRACKET.test(s)&&(i=!1):r===E.EQUAL?n.EQUAL.test(s)?r=E.VALUE:n.WORD.test(s)?(t=s,o.attributes.set(t,void 0),r=E.EQUAL):n.NEW_LINE.test(s)&&(r=E.OPEN_BRACE):r===E.VALUE&&(n.STRING.test(s)?(void 0!==t&&o.attributes.set(t,s),r=E.ATTRIBUTE):n.NEW_LINE.test(s)&&(c(),r=E.CHILDREN));return o.root}(function(e){const t=[],n=e.matchAll(r.MATCH);for(const e of n)t.push(e[0]);return t}(e))))}var g=exports;for(var C in t)g[C]=t[C];t.__esModule&&Object.defineProperty(g,"__esModule",{value:!0})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTdUIsS0FBS3VCLEtBQThCLElBQXBCTCxFQUVyQ0YsRUFBUXBDLEVBQU1YLFdBSVBTLEVBQU1ULFdBQVcrQixLQUFLdUIsR0FFN0JQLEVBQVFwQyxFQUFNNEMsU0FJUDlDLEVBQU1YLGFBQWFpQyxLQUFLdUIsR0FFL0JMLEdBQWtCLEVBSVh4QyxFQUFNVixjQUFjZ0MsS0FBS3VCLEtBRWhDTCxHQUFrQixHQU1iRixJQUFVcEMsRUFBTUosTUFFbkJFLEVBQU1GLE1BQU13QixLQUFLdUIsR0FFbkJQLEVBQVFwQyxFQUFNOEMsTUFJUGhELEVBQU1mLEtBQUtxQyxLQUFLdUIsSUFFdkJSLEVBQWlCUSxFQUVqQk4sRUFBU2xDLFdBQVdvQixJQUFJWSxPQUFnQnpCLEdBRXhDMEIsRUFBUXBDLEVBQU1KLE9BSVBFLEVBQU1ELFNBQVN1QixLQUFLdUIsS0FFM0JQLEVBQVFwQyxFQUFNWCxZQU1UK0MsSUFBVXBDLEVBQU04QyxRQUVuQmhELEVBQU1QLE9BQU82QixLQUFLdUIsU0FFR2pDLElBQW5CeUIsR0FFRkUsRUFBU2xDLFdBQVdvQixJQUFJWSxFQUFnQlEsR0FJMUNQLEVBQVFwQyxFQUFNeUMsV0FJUDNDLEVBQU1ELFNBQVN1QixLQUFLdUIsS0FFM0JELElBRUFOLEVBQVFwQyxFQUFNNEMsV0FRcEIsT0FBT1AsRUFBUzFCLEtHdk9Jb0MsQ0pvSHRCLFNBQWNkLEdBRVosTUFBTWUsRUFBcUIsR0FFckJDLEVBQVdoQixFQUFPZ0IsU0FBU3JFLEVBQU1tQixPQUV2QyxJQUFLLE1BQU1tRCxLQUFTRCxFQUVsQkQsRUFBU3ZDLEtBQUt5QyxFQUFNLElBSXRCLE9BQU9GLEVJbElZRyxDQUFLbEIsTSIsInNvdXJjZXMiOlsid2VicGFjazovL0Byb25hbGRvYmcvY21sL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0Byb25hbGRvYmcvY21sL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9Acm9uYWxkb2JnL2NtbC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0Byb25hbGRvYmcvY21sL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vQHJvbmFsZG9iZy9jbWwvLi9zcmMvc2Nhbm5lci50cyIsIndlYnBhY2s6Ly9Acm9uYWxkb2JnL2NtbC8uL3NyYy9wYXJzZXIudHMiLCJ3ZWJwYWNrOi8vQHJvbmFsZG9iZy9jbWwvLi9zcmMvYW5hbHl6ZXIudHMiLCJ3ZWJwYWNrOi8vQHJvbmFsZG9iZy9jbWwvLi9zcmMvZ2VuZXJhdG9yLnRzIiwid2VicGFjazovL0Byb25hbGRvYmcvY21sLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiY29uc3QgVE9LRU4gPSB7XHJcblxyXG4gIGdldCBTVFJJTkcoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgKFwiKD86Lio/KVwifCcoPzouKj8pJylgKTtcclxuICB9LFxyXG5cclxuICBnZXQgRE9DVFlQRSgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGAoIWRvY3R5cGUpYCwgXCJpXCIpO1xyXG4gIH0sXHJcblxyXG4gIGdldCBXT1JEKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYChcXFxcYig/OltcXFxcdy1dKylcXFxcYilgKTtcclxuICB9LFxyXG5cclxuICBnZXQgTU9EVUxFKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYChAJHt0aGlzLldPUkQuc291cmNlfSlgKTtcclxuICB9LFxyXG5cclxuICBnZXQgS0VZV09SRCgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGAoXFxcXCQke3RoaXMuV09SRC5zb3VyY2V9KWApO1xyXG4gIH0sXHJcblxyXG4gIGdldCBUQUcoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgKCR7dGhpcy5ET0NUWVBFLnNvdXJjZX18JHt0aGlzLldPUkQuc291cmNlfXwke3RoaXMuTU9EVUxFLnNvdXJjZX0pYCwgXCJpXCIpXHJcbiAgfSxcclxuXHJcbiAgZ2V0IE9QRU5fQlJBQ0tFVCgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGAoXFxcXFspYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IENMT1NFX0JSQUNLRVQoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgKFxcXFxdKWApO1xyXG4gIH0sXHJcblxyXG4gIGdldCBCUkFDS0VUUygpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGAoJHt0aGlzLk9QRU5fQlJBQ0tFVC5zb3VyY2V9fCR7dGhpcy5DTE9TRV9CUkFDS0VULnNvdXJjZX0pYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IE9QRU5fQlJBQ0UoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgKHspYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IENMT1NFX0JSQUNFKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYCh9KWApO1xyXG4gIH0sXHJcblxyXG4gIGdldCBCUkFDRVMoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgKCR7dGhpcy5PUEVOX0JSQUNFLnNvdXJjZX18JHt0aGlzLkNMT1NFX0JSQUNFLnNvdXJjZX0pYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IEVRVUFMKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYCg9KWApO1xyXG4gIH0sXHJcblxyXG4gIGdldCBORVdfTElORSgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGAoXFxcXG4pYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IE1BVENIKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYCgke3RoaXMuU1RSSU5HLnNvdXJjZX18JHt0aGlzLlRBRy5zb3VyY2V9fCR7dGhpcy5LRVlXT1JELnNvdXJjZX18JHt0aGlzLkJSQUNLRVRTLnNvdXJjZX18JHt0aGlzLkJSQUNFUy5zb3VyY2V9fCR7dGhpcy5FUVVBTC5zb3VyY2V9fCR7dGhpcy5ORVdfTElORS5zb3VyY2V9KWAsIFwiZ2lcIik7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuY29uc3QgRVhBQ1QgPSB7XHJcblxyXG4gIGdldCBTVFJJTkcoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgXiR7VE9LRU4uU1RSSU5HLnNvdXJjZX0kYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IERPQ1RZUEUoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgXiR7VE9LRU4uRE9DVFlQRS5zb3VyY2V9JGAsIFwiaVwiKTtcclxuICB9LFxyXG5cclxuICBnZXQgV09SRCgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGBeJHtUT0tFTi5XT1JELnNvdXJjZX0kYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IE1PRFVMRSgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGBeJHtUT0tFTi5NT0RVTEUuc291cmNlfSRgKTtcclxuICB9LFxyXG5cclxuICBnZXQgS0VZV09SRCgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGBeJHtUT0tFTi5LRVlXT1JELnNvdXJjZX0kYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IFRBRygpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGBeJHtUT0tFTi5UQUcuc291cmNlfSRgLCBcImlcIilcclxuICB9LFxyXG5cclxuICBnZXQgT1BFTl9CUkFDS0VUKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYF4ke1RPS0VOLk9QRU5fQlJBQ0tFVC5zb3VyY2V9JGApO1xyXG4gIH0sXHJcblxyXG4gIGdldCBDTE9TRV9CUkFDS0VUKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYF4ke1RPS0VOLkNMT1NFX0JSQUNLRVQuc291cmNlfSRgKTtcclxuICB9LFxyXG5cclxuICBnZXQgQlJBQ0tFVFMoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgXiR7VE9LRU4uQlJBQ0tFVFMuc291cmNlfSRgKTtcclxuICB9LFxyXG5cclxuICBnZXQgT1BFTl9CUkFDRSgpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGBeJHtUT0tFTi5PUEVOX0JSQUNFLnNvdXJjZX0kYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IENMT1NFX0JSQUNFKCkge1xyXG4gICAgcmV0dXJuIG5ldyBSZWdFeHAoYF4ke1RPS0VOLkNMT1NFX0JSQUNFLnNvdXJjZX0kYCk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0IEJSQUNFUygpIHtcclxuICAgIHJldHVybiBuZXcgUmVnRXhwKGBeJHtUT0tFTi5CUkFDRVMuc291cmNlfSRgKTtcclxuICB9LFxyXG5cclxuICBnZXQgRVFVQUwoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgXiR7VE9LRU4uRVFVQUwuc291cmNlfSRgKTtcclxuICB9LFxyXG5cclxuICBnZXQgTkVXX0xJTkUoKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgXiR7VE9LRU4uTkVXX0xJTkUuc291cmNlfSRgKTtcclxuICB9LFxyXG5cclxuICBnZXQgTUFUQ0goKSB7XHJcbiAgICByZXR1cm4gbmV3IFJlZ0V4cChgXiR7VE9LRU4uTUFUQ0guc291cmNlfSRgLCBcImdpXCIpO1xyXG4gIH1cclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNjYW4oc3RyaW5nOiBzdHJpbmcpIHtcclxuXHJcbiAgY29uc3QgbGV4QXJyYXk6IHN0cmluZ1tdID0gW107XHJcblxyXG4gIGNvbnN0IG1hdGNoQWxsID0gc3RyaW5nLm1hdGNoQWxsKFRPS0VOLk1BVENIKTtcclxuXHJcbiAgZm9yIChjb25zdCBtYXRjaCBvZiBtYXRjaEFsbCkge1xyXG5cclxuICAgIGxleEFycmF5LnB1c2gobWF0Y2hbMF0pO1xyXG5cclxuICB9XHJcblxyXG4gIHJldHVybiBsZXhBcnJheTtcclxuXHJcbn1cclxuXHJcbmV4cG9ydCB7IHNjYW4sIFRPS0VOLCBFWEFDVCB9OyIsImltcG9ydCB7IEVYQUNUIH0gZnJvbSBcIi4vc2Nhbm5lclwiO1xyXG5cclxuZW51bSBBV0FJVCB7IERPQ1RZUEUsIENISUxEUkVOLCBBVFRSSUJVVEUsIEVRVUFMLCBWQUxVRSwgT1BFTl9CUkFDRSB9O1xyXG5cclxuY2xhc3MgVmlydHVhbE5vZGUge1xyXG5cclxuICBwdWJsaWMgbmFtZTogc3RyaW5nO1xyXG5cclxuICBwdWJsaWMgYXR0cmlidXRlczogTWFwPHN0cmluZywgc3RyaW5nIHwgdW5kZWZpbmVkPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgcHVibGljIGNoaWxkcmVuOiAoVmlydHVhbE5vZGUgfCBzdHJpbmcpW10gPSBbXTtcclxuXHJcbiAgcHVibGljIHBhcmVudD86IFZpcnR1YWxOb2RlO1xyXG5cclxuICBwdWJsaWMgY29uc3RydWN0b3IobmFtZTogc3RyaW5nKSB7XHJcblxyXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcclxuXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgYXBwZW5kQ2hpbGQ8VCBleHRlbmRzIFZpcnR1YWxOb2RlIHwgc3RyaW5nPihjaGlsZDogVCkge1xyXG5cclxuICAgIHRoaXMuY2hpbGRyZW4ucHVzaChjaGlsZCk7XHJcblxyXG4gICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgVmlydHVhbE5vZGUpIHtcclxuXHJcbiAgICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjaGlsZDtcclxuXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0IHJvb3QoKTogVmlydHVhbE5vZGUge1xyXG5cclxuICAgIGlmICh0aGlzLnBhcmVudCAhPT0gdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy5wYXJlbnQucm9vdDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZWxzZSByZXR1cm4gdGhpcztcclxuXHJcbiAgfVxyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gcGFyc2UodG9rZW5MaXN0OiBzdHJpbmdbXSkge1xyXG5cclxuICBsZXQgU1RBVEU6IEFXQUlUID0gQVdBSVQuRE9DVFlQRTtcclxuXHJcbiAgbGV0IGRvY3VtZW50ID0gbmV3IFZpcnR1YWxOb2RlKFwiZG9jdW1lbnRcIik7XHJcblxyXG4gIGxldCBBVFRSSUJVVEVfTkFNRSA9IHVuZGVmaW5lZDtcclxuXHJcbiAgbGV0IElHTk9SRV9ORVdfbElORSA9IGZhbHNlO1xyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVWaXJ0dWFsTm9kZShuYW1lOiBzdHJpbmcpIHtcclxuXHJcbiAgICBjb25zdCBub2RlID0gbmV3IFZpcnR1YWxOb2RlKG5hbWUpO1xyXG5cclxuICAgIGRvY3VtZW50ID0gZG9jdW1lbnQuYXBwZW5kQ2hpbGQobm9kZSk7XHJcblxyXG4gICAgU1RBVEUgPSBBV0FJVC5BVFRSSUJVVEU7XHJcblxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdXBMZXZlbCgpIHtcclxuXHJcbiAgICAvLyBzb2JlIHVtIG7DrXZlbFxyXG4gICAgaWYgKGRvY3VtZW50LnBhcmVudCAhPT0gdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICBkb2N1bWVudCA9IGRvY3VtZW50LnBhcmVudDtcclxuXHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgZm9yIChjb25zdCB0b2tlbiBvZiB0b2tlbkxpc3QpIHtcclxuXHJcbiAgICBpZiAoU1RBVEUgPT09IEFXQUlULkRPQ1RZUEUpIHtcclxuXHJcbiAgICAgIGlmIChFWEFDVC5UQUcudGVzdCh0b2tlbikpIHtcclxuXHJcbiAgICAgICAgY3JlYXRlVmlydHVhbE5vZGUodG9rZW4pO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBlbHNlIGlmIChTVEFURSA9PT0gQVdBSVQuQ0hJTERSRU4pIHtcclxuXHJcbiAgICAgIGlmIChFWEFDVC5TVFJJTkcudGVzdCh0b2tlbikpIHtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYXBwZW5kQ2hpbGQodG9rZW4uc2xpY2UoMSwgLTEpKTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKEVYQUNULktFWVdPUkQudGVzdCh0b2tlbikpIHtcclxuXHJcbiAgICAgICAgZG9jdW1lbnQuYXBwZW5kQ2hpbGQodG9rZW4pO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiAoRVhBQ1QuVEFHLnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIGNyZWF0ZVZpcnR1YWxOb2RlKHRva2VuKTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKEVYQUNULkNMT1NFX0JSQUNFLnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIHVwTGV2ZWwoKTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgZWxzZSBpZiAoU1RBVEUgPT09IEFXQUlULk9QRU5fQlJBQ0UpIHtcclxuXHJcbiAgICAgIGlmIChFWEFDVC5PUEVOX0JSQUNFLnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIFNUQVRFID0gQVdBSVQuQ0hJTERSRU47XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIHtcclxuXHJcbiAgICAgICAgdXBMZXZlbCgpO1xyXG5cclxuICAgICAgICBpZiAoRVhBQ1QuS0VZV09SRC50ZXN0KHRva2VuKSkge1xyXG5cclxuICAgICAgICAgIGRvY3VtZW50LmFwcGVuZENoaWxkKHRva2VuKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbHNlIGlmIChFWEFDVC5TVFJJTkcudGVzdCh0b2tlbikpIHtcclxuXHJcbiAgICAgICAgICBkb2N1bWVudC5hcHBlbmRDaGlsZCh0b2tlbi5zbGljZSgxLCAtMSkpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGVsc2UgaWYgKEVYQUNULlRBRy50ZXN0KHRva2VuKSkge1xyXG5cclxuICAgICAgICAgIGNyZWF0ZVZpcnR1YWxOb2RlKHRva2VuKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBlbHNlIGlmIChTVEFURSA9PT0gQVdBSVQuQVRUUklCVVRFKSB7XHJcblxyXG4gICAgICBpZiAoRVhBQ1QuV09SRC50ZXN0KHRva2VuKSkge1xyXG5cclxuICAgICAgICBBVFRSSUJVVEVfTkFNRSA9IHRva2VuO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5hdHRyaWJ1dGVzLnNldChBVFRSSUJVVEVfTkFNRSwgdW5kZWZpbmVkKTtcclxuXHJcbiAgICAgICAgU1RBVEUgPSBBV0FJVC5FUVVBTDtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKEVYQUNULk5FV19MSU5FLnRlc3QodG9rZW4pICYmIElHTk9SRV9ORVdfbElORSA9PT0gZmFsc2UpIHtcclxuXHJcbiAgICAgICAgU1RBVEUgPSBBV0FJVC5PUEVOX0JSQUNFO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiAoRVhBQ1QuT1BFTl9CUkFDRS50ZXN0KHRva2VuKSkge1xyXG5cclxuICAgICAgICBTVEFURSA9IEFXQUlULkNISUxEUkVOO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiAoRVhBQ1QuT1BFTl9CUkFDS0VULnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIElHTk9SRV9ORVdfbElORSA9IHRydWU7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIGlmIChFWEFDVC5DTE9TRV9CUkFDS0VULnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIElHTk9SRV9ORVdfbElORSA9IGZhbHNlO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBlbHNlIGlmIChTVEFURSA9PT0gQVdBSVQuRVFVQUwpIHtcclxuXHJcbiAgICAgIGlmIChFWEFDVC5FUVVBTC50ZXN0KHRva2VuKSkge1xyXG5cclxuICAgICAgICBTVEFURSA9IEFXQUlULlZBTFVFO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgZWxzZSBpZiAoRVhBQ1QuV09SRC50ZXN0KHRva2VuKSkge1xyXG5cclxuICAgICAgICBBVFRSSUJVVEVfTkFNRSA9IHRva2VuO1xyXG5cclxuICAgICAgICBkb2N1bWVudC5hdHRyaWJ1dGVzLnNldChBVFRSSUJVVEVfTkFNRSwgdW5kZWZpbmVkKTtcclxuXHJcbiAgICAgICAgU1RBVEUgPSBBV0FJVC5FUVVBTDtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKEVYQUNULk5FV19MSU5FLnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIFNUQVRFID0gQVdBSVQuT1BFTl9CUkFDRTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgZWxzZSBpZiAoU1RBVEUgPT09IEFXQUlULlZBTFVFKSB7XHJcblxyXG4gICAgICBpZiAoRVhBQ1QuU1RSSU5HLnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIGlmIChBVFRSSUJVVEVfTkFNRSAhPT0gdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICAgICAgZG9jdW1lbnQuYXR0cmlidXRlcy5zZXQoQVRUUklCVVRFX05BTUUsIHRva2VuKTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBTVEFURSA9IEFXQUlULkFUVFJJQlVURTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgaWYgKEVYQUNULk5FV19MSU5FLnRlc3QodG9rZW4pKSB7XHJcblxyXG4gICAgICAgIHVwTGV2ZWwoKTtcclxuXHJcbiAgICAgICAgU1RBVEUgPSBBV0FJVC5DSElMRFJFTjtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGRvY3VtZW50LnJvb3Q7XHJcblxyXG59XHJcblxyXG5leHBvcnQgeyBwYXJzZSwgVmlydHVhbE5vZGUgfTsiLCJpbXBvcnQgeyBWaXJ0dWFsTm9kZSB9IGZyb20gXCIuL3BhcnNlclwiO1xyXG5cclxuaW1wb3J0IHsgRVhBQ1QgfSBmcm9tIFwiLi9zY2FubmVyXCI7XHJcblxyXG5jb25zdCBkZWNsYXJlTGlzdDogTWFwPHN0cmluZywgVmlydHVhbE5vZGU+ID0gbmV3IE1hcCgpO1xyXG5cclxuZnVuY3Rpb24gcmVwbGFjZUNoaWxkcmVuKHZpcnR1YWxOb2RlOiBWaXJ0dWFsTm9kZSwgY2hpbGRyZW46IChWaXJ0dWFsTm9kZSB8IHN0cmluZylbXSkge1xyXG5cclxuICBmb3IgKGNvbnN0IGNoaWxkIG9mIHZpcnR1YWxOb2RlLmNoaWxkcmVuKSB7XHJcblxyXG4gICAgaWYgKGNoaWxkID09PSBcIiRjaGlsZHJlblwiKSB7XHJcblxyXG4gICAgICBjb25zdCBpbmRleCA9IHZpcnR1YWxOb2RlLmNoaWxkcmVuLmluZGV4T2YoY2hpbGQpO1xyXG5cclxuICAgICAgdmlydHVhbE5vZGUuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxLCAuLi5jaGlsZHJlbik7XHJcblxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBhbmFseXplKHZpcnR1YWxOb2RlOiBWaXJ0dWFsTm9kZSwgZGVjbGFyZT86IGJvb2xlYW4pOiBWaXJ0dWFsTm9kZSB7XHJcblxyXG4gIGZvciAoY29uc3QgY2hpbGQgb2YgdmlydHVhbE5vZGUuY2hpbGRyZW4pIHtcclxuXHJcbiAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBWaXJ0dWFsTm9kZSkge1xyXG5cclxuICAgICAgaWYgKC9eKGRlY2xhcmUpJC8udGVzdChjaGlsZC5uYW1lKSkge1xyXG5cclxuICAgICAgICBhbmFseXplKGNoaWxkLCB0cnVlKTtcclxuXHJcbiAgICAgICAgdmlydHVhbE5vZGUuY2hpbGRyZW4gPSB2aXJ0dWFsTm9kZS5jaGlsZHJlbi5maWx0ZXIoYSA9PiBhICE9PSBjaGlsZCk7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICBlbHNlIGlmIChFWEFDVC5NT0RVTEUudGVzdChjaGlsZC5uYW1lKSkge1xyXG5cclxuICAgICAgICBpZiAoZGVjbGFyZSA9PT0gdW5kZWZpbmVkIHx8IGRlY2xhcmUgPT09IHRydWUpIHtcclxuXHJcbiAgICAgICAgICBkZWNsYXJlTGlzdC5zZXQoY2hpbGQubmFtZSwgY2hpbGQpO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGVsc2Uge1xyXG5cclxuICAgICAgICAgIGNvbnN0IG9iamVjdCA9IGRlY2xhcmVMaXN0LmdldChjaGlsZC5uYW1lKTtcclxuXHJcbiAgICAgICAgICBpZiAob2JqZWN0ICE9PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlID0gb2JqZWN0LmNoaWxkcmVuWzBdO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRlbXBsYXRlIGluc3RhbmNlb2YgVmlydHVhbE5vZGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgY29uc3QgY2xvbmUgPSBuZXcgVmlydHVhbE5vZGUodGVtcGxhdGUubmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgIGZvciAoY29uc3QgYXR0cmlidXRlIG9mIHRlbXBsYXRlLmF0dHJpYnV0ZXMpIHtcclxuXHJcbiAgICAgICAgICAgICAgICBjbG9uZS5hdHRyaWJ1dGVzLnNldChhdHRyaWJ1dGVbMF0sIGF0dHJpYnV0ZVsxXSk7XHJcblxyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgY2hpbGQuYXR0cmlidXRlcykge1xyXG5cclxuICAgICAgICAgICAgICAgIGNsb25lLmF0dHJpYnV0ZXMuc2V0KGF0dHJpYnV0ZVswXSwgYXR0cmlidXRlWzFdKTtcclxuXHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRlbXBsYXRlLmNoaWxkcmVuKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgY2xvbmUuY2hpbGRyZW4ucHVzaChjaGlsZCk7XHJcblxyXG4gICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgY2xvbmUucGFyZW50ID0gY2hpbGQucGFyZW50O1xyXG5cclxuICAgICAgICAgICAgICByZXBsYWNlQ2hpbGRyZW4oY2xvbmUsIGNoaWxkLmNoaWxkcmVuKTtcclxuXHJcbiAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB2aXJ0dWFsTm9kZS5jaGlsZHJlbi5pbmRleE9mKGNoaWxkKTtcclxuXHJcbiAgICAgICAgICAgICAgdmlydHVhbE5vZGUuY2hpbGRyZW4uc3BsaWNlKGluZGV4LCAxLCBjbG9uZSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGVsc2UgdGhyb3cgbmV3IEVycm9yKGBNb2R1bGUgJHtjaGlsZC5uYW1lfSBub3QgZm91bmQhYCk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGVsc2UgYW5hbHl6ZShjaGlsZCwgZmFsc2UpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICByZXR1cm4gdmlydHVhbE5vZGU7XHJcblxyXG59XHJcblxyXG5leHBvcnQgeyBhbmFseXplIH07IiwiaW1wb3J0IHsgVmlydHVhbE5vZGUgfSBmcm9tIFwiLi9wYXJzZXJcIjtcclxuXHJcbmNvbnN0IFZPSURfVEFHID0gbmV3IFJlZ0V4cChgXighZG9jdHlwZXxhcmVhfGJhc2V8YnJ8Y29sfGNvbW1hbmR8ZW1iZWR8aHJ8aW1nfGlucHV0fGtleWdlbnxsaW5rfG1ldGF8cGFyYW18c291cmNlfHRyYWNrfHdicikkYCwgXCJpXCIpO1xyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGUodmlydHVhbE5vZGU6IFZpcnR1YWxOb2RlKTogc3RyaW5nIHtcclxuXHJcbiAgY29uc3QgY2hpbGRyZW46IHN0cmluZ1tdID0gW107XHJcblxyXG4gIGNvbnN0IGF0dHJpYnV0ZXM6IHN0cmluZ1tdID0gW107XHJcblxyXG4gIGZvciAoY29uc3QgY2hpbGQgb2YgdmlydHVhbE5vZGUuY2hpbGRyZW4pIHtcclxuXHJcbiAgICBjaGlsZHJlbi5wdXNoKGNoaWxkIGluc3RhbmNlb2YgVmlydHVhbE5vZGUgPyBnZW5lcmF0ZShjaGlsZCkgOiBjaGlsZCk7XHJcblxyXG4gIH1cclxuXHJcbiAgZm9yIChjb25zdCBhdHRyaWJ1dGUgb2YgdmlydHVhbE5vZGUuYXR0cmlidXRlcykge1xyXG5cclxuICAgIGF0dHJpYnV0ZXMucHVzaChgICR7YXR0cmlidXRlWzBdfSR7YXR0cmlidXRlWzFdID8gYD0ke2F0dHJpYnV0ZVsxXX1gIDogXCJcIn1gKTtcclxuXHJcbiAgfVxyXG5cclxuICBpZiAodmlydHVhbE5vZGUucGFyZW50ICE9PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICByZXR1cm4gYDwke3ZpcnR1YWxOb2RlLm5hbWV9JHthdHRyaWJ1dGVzLmpvaW4oXCJcIil9PiR7Vk9JRF9UQUcudGVzdCh2aXJ0dWFsTm9kZS5uYW1lKSA/IFwiXCIgOiBgJHtjaGlsZHJlbi5qb2luKFwiXCIpfTwvJHt2aXJ0dWFsTm9kZS5uYW1lfT5gfWA7XHJcblxyXG4gIH1cclxuXHJcbiAgZWxzZSByZXR1cm4gYCR7Y2hpbGRyZW4uam9pbihcIlwiKX1gO1xyXG5cclxufVxyXG5cclxuZXhwb3J0IHsgZ2VuZXJhdGUgfTsiLCJpbXBvcnQgeyBzY2FuIH0gZnJvbSBcIi4vc2Nhbm5lclwiO1xyXG5cclxuaW1wb3J0IHsgcGFyc2UgfSBmcm9tIFwiLi9wYXJzZXJcIjtcclxuXHJcbmltcG9ydCB7IGFuYWx5emUgfSBmcm9tIFwiLi9hbmFseXplclwiO1xyXG5cclxuaW1wb3J0IHsgZ2VuZXJhdGUgfSBmcm9tIFwiLi9nZW5lcmF0b3JcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0cmFuc3BpbGUoc3RyaW5nOiBzdHJpbmcpIHtcclxuXHJcbiAgY29uc3Qgc2NhblJlc3VsdCA9IHNjYW4oc3RyaW5nKTtcclxuXHJcbiAgY29uc3QgcGFyc2VSZXN1bHQgPSBwYXJzZShzY2FuUmVzdWx0KTtcclxuXHJcbiAgY29uc3QgYW5hbHl6ZVJlc3VsdCA9IGFuYWx5emUocGFyc2VSZXN1bHQpO1xyXG5cclxuICByZXR1cm4gZ2VuZXJhdGUoYW5hbHl6ZVJlc3VsdCk7XHJcblxyXG59Il0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsIlRPS0VOIiwiUmVnRXhwIiwidGhpcyIsIldPUkQiLCJzb3VyY2UiLCJET0NUWVBFIiwiTU9EVUxFIiwiT1BFTl9CUkFDS0VUIiwiQ0xPU0VfQlJBQ0tFVCIsIk9QRU5fQlJBQ0UiLCJDTE9TRV9CUkFDRSIsIlNUUklORyIsIlRBRyIsIktFWVdPUkQiLCJCUkFDS0VUUyIsIkJSQUNFUyIsIkVRVUFMIiwiTkVXX0xJTkUiLCJFWEFDVCIsIk1BVENIIiwiQVdBSVQiLCJWaXJ0dWFsTm9kZSIsIm5hbWUiLCJhdHRyaWJ1dGVzIiwiTWFwIiwiY2hpbGRyZW4iLCJwYXJlbnQiLCJhcHBlbmRDaGlsZCIsImNoaWxkIiwicHVzaCIsInVuZGVmaW5lZCIsInJvb3QiLCJkZWNsYXJlTGlzdCIsInJlcGxhY2VDaGlsZHJlbiIsInZpcnR1YWxOb2RlIiwiaW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiYW5hbHl6ZSIsImRlY2xhcmUiLCJ0ZXN0IiwiZmlsdGVyIiwiYSIsInNldCIsIm9iamVjdCIsIkVycm9yIiwidGVtcGxhdGUiLCJjbG9uZSIsImF0dHJpYnV0ZSIsIlZPSURfVEFHIiwiZ2VuZXJhdGUiLCJqb2luIiwidHJhbnNwaWxlIiwic3RyaW5nIiwidG9rZW5MaXN0IiwiQVRUUklCVVRFX05BTUUiLCJTVEFURSIsImRvY3VtZW50IiwiSUdOT1JFX05FV19sSU5FIiwiY3JlYXRlVmlydHVhbE5vZGUiLCJub2RlIiwiQVRUUklCVVRFIiwidXBMZXZlbCIsInRva2VuIiwiQ0hJTERSRU4iLCJzbGljZSIsIlZBTFVFIiwicGFyc2UiLCJsZXhBcnJheSIsIm1hdGNoQWxsIiwibWF0Y2giLCJzY2FuIl0sInNvdXJjZVJvb3QiOiIifQ==